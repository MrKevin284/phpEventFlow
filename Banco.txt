create database EventFlow;

use EventFlow;

CREATE TABLE tipo_usuario (
  id_funcao INTEGER,
  descricao VARCHAR(100),
  PRIMARY KEY (id_funcao)
);

CREATE TABLE usuario (
  idusuario INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
  nome VARCHAR(300),
  cpf_cnpj VARCHAR(18),
  tipo_user INTEGER,
  telefone VARCHAR(20),
  FOREIGN KEY (tipo_user) REFERENCES tipo_usuario (id_funcao)
);

CREATE TABLE login (
  idlogin INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
  email VARCHAR(300) NOT NULL,
  senha VARCHAR(150) NOT NULL,
  idusuario INT NOT NULL,
  FOREIGN KEY (idusuario) REFERENCES usuario (idusuario)
);

CREATE TABLE eventos (
  idevento INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
  nome_evento VARCHAR(250) NOT NULL,
  endereco VARCHAR(200) NOT NULL,
  descricao VARCHAR(500) NOT NULL,
  data_evento DATE NOT NULL,
  horario DATETIME,
  idusuario INT NOT NULL,
  FOREIGN KEY (idusuario) REFERENCES usuario (idusuario)
);

CREATE TABLE tipo_ingresso (
  id_tipoingresso INT NOT NULL PRIMARY KEY,
  descricao VARCHAR(100)
);

CREATE TABLE ingresso (
  id_ingresso INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
  quantidade INT NOT NULL,
  valor DECIMAL(10,2),
  id_tipoingresso INT NOT NULL,
  idevento INT NOT NULL,
  FOREIGN KEY (id_tipoingresso) REFERENCES tipo_ingresso (id_tipoingresso),
  FOREIGN KEY (idevento) REFERENCES eventos (idevento)
);

CREATE TABLE carrinho (
  idcarrinho INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
  idusuario INT NOT NULL,
  FOREIGN KEY (idusuario) REFERENCES usuario (idusuario)
);

CREATE TABLE carrinho_ingresso (
  idcarrinho INT NOT NULL,
  id_ingresso INT NOT NULL,
  quantidade INT NOT NULL,
  PRIMARY KEY (idcarrinho, id_ingresso),
  FOREIGN KEY (idcarrinho) REFERENCES carrinho (idcarrinho),
  FOREIGN KEY (id_ingresso) REFERENCES ingresso (id_ingresso)
);

CREATE TABLE venda (
  id_venda INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
  nome_item VARCHAR(200) NOT NULL,
  quantidade INT NOT NULL,
  preco_unitario DECIMAL(10,2)
);

CREATE TABLE iten_loja (
  iditem_loja INT AUTO_INCREMENT NOT NULL PRIMARY KEY,
  nome VARCHAR(250) NOT NULL,
  descricao VARCHAR(300) NOT NULL,
  quantidade INT NOT NULL,
  valor DECIMAL(10,2) NOT NULL,
  idevento INT NOT NULL,
  FOREIGN KEY (idevento) REFERENCES eventos (idevento)
);

INSERT INTO tipo_usuario (id_funcao, descricao) VALUES (1, 'User Comum');
INSERT INTO tipo_usuario (id_funcao, descricao) VALUES (2, 'User Empresarial');

INSERT INTO usuario (nome, cpf_cnpj, tipo_user, telefone)
VALUES
  ('João da Silva', '12345678900', 2, '(11) 987654321'),
  ('Maria Souza', '98765432100', 2, '(21) 123456789');

INSERT INTO usuario (nome, cpf_cnpj, tipo_user, telefone)
VALUES
  ('Pedro Santos', '11122233344', 1, '(31) 55556666'),
  ('Ana Oliveira', '55544433322', 1, '(41) 99998888');

INSERT INTO login (email, senha, idusuario)
VALUES
  ('joao.silva@example.com', 'senha123', 1),
  ('maria.souza@example.com', 'senha456', 2),
  ('pedro.santos@example.com', 'senha789', 3),
  ('ana.oliveira@example.com', 'senha012', 4);
  
  INSERT INTO eventos (nome_evento, endereco, descricao, data_evento, horario, idusuario)
VALUES
  ('BGS - 2023', 'Rua 13 São Paulo SP', 'Venha fazer parte dessa aventura!', '2023-01-01', '2023-01-01 12:00:00', 2),
  ('BasquetBol 2023', 'Rua 11 Rio de Janeiro RJ', 'Venha fazer parte dessa aventura!', '2023-02-01', '2023-02-01 14:00:00', 2);
